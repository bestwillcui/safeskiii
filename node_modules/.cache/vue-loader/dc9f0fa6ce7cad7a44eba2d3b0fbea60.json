{"remainingRequest":"/Users/Will/Desktop/safeskiii/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Will/Desktop/safeskiii/src/components/MainContent/BroadcastW.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Will/Desktop/safeskiii/src/components/MainContent/BroadcastW.vue","mtime":1607530445320},{"path":"/Users/Will/Desktop/safeskiii/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Will/Desktop/safeskiii/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/Will/Desktop/safeskiii/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Will/Desktop/safeskiii/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiCmltcG9ydCBGaXJlYmFzZSBmcm9tICdmaXJlYmFzZScKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTG9naW4nLAogIHByb3BzOiB7CiAgICBtc2c6IFN0cmluZywKICAgIGJ1c2k6IFN0cmluZwogIH0sCiAgZGF0YSgpewogICAgcmV0dXJuewogICAgICBidXNpbmVzcyA6IGZhbHNlLAogICAgICBhbm5vdW5jZW1lbnRzIDogW10sCiAgICAgIGJyb2FkY2FzdENvbnRlbnQ6ICIiLAogICAgICBkYjogW10KICAgIH0KICB9LAogIHdhdGNoOiB7IAogICAgYnVzaTogZnVuY3Rpb24obmV3VmFsLCBvbGRWYWwpIHsgLy8gd2F0Y2ggaXQKICAgICAgY29uc29sZS5sb2coJ1Byb3AgY2hhbmdlZDogJywgbmV3VmFsLCAnIHwgd2FzOiAnLCBvbGRWYWwpCiAgICAgIHRoaXMuZGIgPSBGaXJlYmFzZS5maXJlc3RvcmUoKQogICAgICBsZXQgYXV0aGVudGljYXRlZCA9IHRoaXMuJGNvb2tpZS5nZXQoJ3NhZmVza2lpaS1hdXRoJyk7CiAgICAgIGlmKCFhdXRoZW50aWNhdGVkKSB7CiAgICAgICAgY29uc29sZS5sb2coJ25vdCBzaWduZWQgaW4gOignKTsKICAgICAgfQogICAgICB0aGlzLiRiaW5kKCd1c2VycycsIHRoaXMuZGIuY29sbGVjdGlvbigndXNlcnMnKSkudGhlbih1c2VycyA9PiB7CiAgICAgIHRoaXMudXNlcnMgPT09IHVzZXJzCiAgICAgIH0pOwoKICAgICAgdGhpcy4kYmluZCgnYW5ub3VuY2VtZW50cycsIHRoaXMuZGIuY29sbGVjdGlvbignYnVzaW5lc3NlcycpLmRvYyh0aGlzLmJ1c2kpLmNvbGxlY3Rpb24oJ2Jyb2FkY2FzdCcpKS50aGVuKGFubm91bmNlbWVudHMgPT4gewogICAgICBjb25zb2xlLmxvZyh0aGlzLmJ1c2kpOwogICAgICAvLyB0aGlzLiRiaW5kKCdhbm5vdW5jZW1lbnRzJywgdGhpcy5kYi5jb2xsZWN0aW9uKCdidXNpbmVzc2VzJykuZG9jKCdhbHRhIHNraSByZXNvcnQnKS5jb2xsZWN0aW9uKCdicm9hZGNhc3QnKSkudGhlbihhbm5vdW5jZW1lbnRzID0+IHsKICAgICAgdGhpcy5hbm5vdW5jZW1lbnRzID09PSBhbm5vdW5jZW1lbnRzCiAgICAgIH0pOwogICAgfQogIH0sCgogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5kYiA9IEZpcmViYXNlLmZpcmVzdG9yZSgpCiAgICBsZXQgYXV0aGVudGljYXRlZCA9IHRoaXMuJGNvb2tpZS5nZXQoJ3NhZmVza2lpaS1hdXRoJyk7CiAgICBpZighYXV0aGVudGljYXRlZCkgewogICAgICBjb25zb2xlLmxvZygnbm90IHNpZ25lZCBpbiA6KCcpOwogICAgfQogICAgdGhpcy4kYmluZCgndXNlcnMnLCB0aGlzLmRiLmNvbGxlY3Rpb24oJ3VzZXJzJykpLnRoZW4odXNlcnMgPT4gewogICAgdGhpcy51c2VycyA9PT0gdXNlcnMKICAgIH0pOwoKICAgIHRoaXMuJGJpbmQoJ2Fubm91bmNlbWVudHMnLCB0aGlzLmRiLmNvbGxlY3Rpb24oJ2J1c2luZXNzZXMnKS5kb2ModGhpcy5idXNpKS5jb2xsZWN0aW9uKCdicm9hZGNhc3QnKSkudGhlbihhbm5vdW5jZW1lbnRzID0+IHsKICAgIGNvbnNvbGUubG9nKHRoaXMuYnVzaSk7CiAgICAvLyB0aGlzLiRiaW5kKCdhbm5vdW5jZW1lbnRzJywgdGhpcy5kYi5jb2xsZWN0aW9uKCdidXNpbmVzc2VzJykuZG9jKCdhbHRhIHNraSByZXNvcnQnKS5jb2xsZWN0aW9uKCdicm9hZGNhc3QnKSkudGhlbihhbm5vdW5jZW1lbnRzID0+IHsKICAgIHRoaXMuYW5ub3VuY2VtZW50cyA9PT0gYW5ub3VuY2VtZW50cwogICAgfSk7CiAgfSwKCiAgbW91bnRlZCgpewogICAgLy9JcyBpdCBhIGJ1c2luZXNzIGxvZ2dlZCBpbiBub3c/CiAgICBheGlvcy5nZXQoImFwaS91c2VycyIpCiAgICAudGhlbiggKHJlc3BvbnNlKSA9PiB7CiAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YS5pc0J1c2luZXNzKQogICAgICB0aGlzLmJ1c2luZXNzID0gcmVzcG9uc2UuZGF0YS5pc0J1c2luZXNzOwogICAgfSkKICAgIC5jYXRjaCgpCiAgfSwKICBjb21wdXRlZDp7CiAgfSwKCiAgbWV0aG9kczogewogICAgcG9zdEJyb2FkY2FzdCgpewogICAgICBjb25zdCBib2R5Q29udGVudCA9IHttZXNzYWdlOiB0aGlzLmJyb2FkY2FzdENvbnRlbnQgfTsgIC8vIFRPRE86IE1ha2UgbG9jYXRpb24gYSBwcm9wCiAgICAgIGF4aW9zLnBvc3QoIi9hcGkvdXNlcnMvYnJvYWRjYXN0LyIsIGJvZHlDb250ZW50KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIC8vIGNvbnN0IGZ1bGxSZXNwb25zZSA9IHJlcy5yZXNwb25zZSA9PT0gdW5kZWZpbmVkID8gcmVzIDogcmVzLnJlc3BvbnNlOwogICAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdoaSBicm9hZCB1cGRhdGUnKTsKCiAgICAgICAgICB0aGlzLmRiLmNvbGxlY3Rpb24oJ2J1c2luZXNzZXMnKS5kb2ModGhpcy5idXNpKS5jb2xsZWN0aW9uKCdicm9hZGNhc3QnKS5kb2MoJ21haW4nKS5zZXQoewogICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmJyb2FkY2FzdENvbnRlbnQKICAgICAgICAgIH0pCiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRG9jdW1lbnQgc3VjY2Vzc2Z1bGx5IHdyaXR0ZW4hIik7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3Igd3JpdGluZyBkb2N1bWVudDogIiwgZXJyb3IpOwogICAgICAgICAgfSk7CgogICAgICAgICAgdGhpcy5icm9hZGNhc3RDb250ZW50ID0gIiI7CiAgICAgICAgICBjb25zb2xlLmxvZygnZG9uZT8nKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICB0aGlzLmVycm9ycy5wdXNoKHRoaXMuc2hvd1Jlc3BvbnNlKGVycikpOwogICAgICAgICAgdGhpcy5jbGVhck1lc3NhZ2VzKCk7CiAgICAgICAgfSk7CiAgICB9LAoKICAgIGdldEFubm91bmNlbWVudCgpewogICAgICBsZXQgdXNlcm5hbWUgPSAiYiI7CiAgICAgIC8vIGxldCBib2R5ID0ge3VzZXJuYW1lOiAiYiJ9CiAgICAgIC8vY29uc29sZS5sb2coYm9keUNvbnRlbnQpOwogICAgICAvLyBjb25zb2xlLmxvZyhib2R5LnVzZXJuYW1lKTsKICAgICAgYXhpb3MuZ2V0KGAvYXBpL3VzZXJzL2Fubm91bmNlbWVudHMvJHt1c2VybmFtZX1gKQogICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLmFubm91bmNlbWVudHMgPSByZXNwb25zZVswXTsKICAgICAgfSkKICAgICAgLmNhdGNoKCk7CiAgICB9CgogICAgLy8gaXNCdXNpbmVzcygpewogICAgLy8gICBsZXQgYnVzaW5lc3MgPSBmYWxzZTsKICAgIC8vICAgYXhpb3MuZ2V0KCJhcGkvdXNlcnMvIikKICAgIC8vICAgLnRoZW4oIChyZXNwb25zZSkgPT4gewogICAgLy8gICAgIGJ1c2luZXNzID0gcmVzcG9uc2UuZGF0YS5pc0J1c2luZXNzOwogICAgLy8gICAgIGNvbnNvbGUubG9nKGJ1c2luZXNzKTsKICAgIC8vICAgfSkKICAgIC8vICAgLmNhdGNoKCk7CiAgICAvLyAgIHJldHVybiBidXNpbmVzczsKICAgIC8vIH0KICB9Cgp9Cg=="},{"version":3,"sources":["BroadcastW.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"BroadcastW.vue","sourceRoot":"src/components/MainContent","sourcesContent":["<template>\n  <div class=\"hello\">\n    <div class=\"title\" v-if='announcements.length'>\n          <p id=\"cmts\" class=\"announcements\" v-for=\"a in announcements\" :key=\"a.message\">\n            {{ a.message }}\n          </p> \n        </div>\n    <div v-else class=\"title\">No broadcasts yet! </div>\n\n    <!-- <button type = \"button\" v-on:click=\"getAnnouncement()\"> See Announcement </button> -->\n\n    <input type=\"text\" id=\"broadcast\" name=\"broadcast\" v-model='broadcastContent' v-if='business'>\n    <button type=\"button\" v-on:click=\"postBroadcast()\" v-if='business'>Post!</button>\n\n  </div>\n</template>\n\n<script>\n\nimport axios from \"axios\"\nimport Firebase from 'firebase'\n\nexport default {\n  name: 'Login',\n  props: {\n    msg: String,\n    busi: String\n  },\n  data(){\n    return{\n      business : false,\n      announcements : [],\n      broadcastContent: \"\",\n      db: []\n    }\n  },\n  watch: { \n    busi: function(newVal, oldVal) { // watch it\n      console.log('Prop changed: ', newVal, ' | was: ', oldVal)\n      this.db = Firebase.firestore()\n      let authenticated = this.$cookie.get('safeskiii-auth');\n      if(!authenticated) {\n        console.log('not signed in :(');\n      }\n      this.$bind('users', this.db.collection('users')).then(users => {\n      this.users === users\n      });\n\n      this.$bind('announcements', this.db.collection('businesses').doc(this.busi).collection('broadcast')).then(announcements => {\n      console.log(this.busi);\n      // this.$bind('announcements', this.db.collection('businesses').doc('alta ski resort').collection('broadcast')).then(announcements => {\n      this.announcements === announcements\n      });\n    }\n  },\n\n  created: function() {\n    this.db = Firebase.firestore()\n    let authenticated = this.$cookie.get('safeskiii-auth');\n    if(!authenticated) {\n      console.log('not signed in :(');\n    }\n    this.$bind('users', this.db.collection('users')).then(users => {\n    this.users === users\n    });\n\n    this.$bind('announcements', this.db.collection('businesses').doc(this.busi).collection('broadcast')).then(announcements => {\n    console.log(this.busi);\n    // this.$bind('announcements', this.db.collection('businesses').doc('alta ski resort').collection('broadcast')).then(announcements => {\n    this.announcements === announcements\n    });\n  },\n\n  mounted(){\n    //Is it a business logged in now?\n    axios.get(\"api/users\")\n    .then( (response) => {\n      //console.log(response.data.isBusiness)\n      this.business = response.data.isBusiness;\n    })\n    .catch()\n  },\n  computed:{\n  },\n\n  methods: {\n    postBroadcast(){\n      const bodyContent = {message: this.broadcastContent };  // TODO: Make location a prop\n      axios.post(\"/api/users/broadcast/\", bodyContent)\n        .then((res) => {\n          // const fullResponse = res.response === undefined ? res : res.response;\n          console.log(res);\n          console.log('hi broad update');\n\n          this.db.collection('businesses').doc(this.busi).collection('broadcast').doc('main').set({\n            message: this.broadcastContent\n          })\n          .then(function() {\n              console.log(\"Document successfully written!\");\n          })\n          .catch(function(error) {\n              console.error(\"Error writing document: \", error);\n          });\n\n          this.broadcastContent = \"\";\n          console.log('done?');\n        })\n        .catch((err) => {\n          this.errors.push(this.showResponse(err));\n          this.clearMessages();\n        });\n    },\n\n    getAnnouncement(){\n      let username = \"b\";\n      // let body = {username: \"b\"}\n      //console.log(bodyContent);\n      // console.log(body.username);\n      axios.get(`/api/users/announcements/${username}`)\n      .then((response) => {\n        this.announcements = response[0];\n      })\n      .catch();\n    }\n\n    // isBusiness(){\n    //   let business = false;\n    //   axios.get(\"api/users/\")\n    //   .then( (response) => {\n    //     business = response.data.isBusiness;\n    //     console.log(business);\n    //   })\n    //   .catch();\n    //   return business;\n    // }\n  }\n\n}\n</script>\n\n<style scoped>\n.hello {\n  font-family: \"Red Hat Text\";\n  background-color: #FF9C9C;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  border-style: solid;\n  border-width: 2px;\n  border-radius: 15px;\n  padding: 30px;\n  box-shadow: 2px 2px;\n}\n\n.hello:hover{\n    box-shadow: 0 5px 5px;\n    transform: scale(1.001);\n}\n\n.title {\n  font-size: 24px;\n}\n\n#broadcast {\n  width: 100%;\n  padding: 12px 20px;\n  margin: 8px 0;\n  display: inline-block;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  box-sizing: border-box;\n  font-family: \"Red Hat Text\";\n}\n\nbutton {\n  margin: 0.5rem 1rem;\n  cursor: pointer;\n  background: rgba(0, 100, 148, 0.5);\n  box-sizing: border-box;\n  box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);\n  border-radius: 20px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  /* border-radius: 5px; */\n  padding: 6px 0px;\n  width: 150px;\n  text-align: center;\n  font-family: \"Red Hat Text\";\n}\n</style>"]}]}